# Description: /proc file system utilities
# URL:         https://gitlab.com/procps-ng/procps
# Depends on:  ncurses

name=procps
version=3.3.17
release=1
source=(http://downloads.sourceforge.net/project/$name-ng/Production/$name-ng-$version.tar.xz
	sysctl.conf)

build() {
	cd $name-$version

	./configure \
		--prefix=/usr        \
		--sbindir=/sbin      \
		--libdir=/usr/lib    \
		--sysconfdir=/etc    \
		--disable-nls        \
		--disable-kill       \
		--disable-modern-top \

	make V=1
	make DESTDIR=$PKG install

	install -d $PKG/bin $PKG/lib
	mv $PKG/usr/bin/ps             $PKG/bin
	mv $PKG/usr/bin/pidof          $PKG/bin
	mv $PKG/usr/lib/libprocps.so.* $PKG/lib

	ln -sf ../../lib/$(readlink $PKG/lib/libprocps.so.8) \
		$PKG/usr/lib/libprocps.so

	install -Dm0644 $SRC/sysctl.conf -t $PKG/etc

	# remove localized man pages
	(cd $PKG/usr/share/man;
	find . -type d \
		-not -name man\* -and \
		-not -name '.'   -and \
		-not -name '..' | xargs rm -rf)

	rm -r $PKG/usr/share/doc
}
